方案目标：
1. 监控所有软件的的联网方式（联网协议），联网IP，网络速度，以及联网软件的软件版本、名称、路径、线程等信息
2. 针对整体流量和单个软件的流量进行监控和控制，记录数据保存至数据库，使用图标形式进行展示。收集的信息包括：连接开始时间、连接时长、流量量、流量类型、程序名称、程序版本、程序路径、带宽占用量、软件发行商、联网的目标网址或IP、联网的类型；
3. 并对新增的联网的软件进行监控，有新增联网软件提示用户是否拦截，或默认拦截提示用户是否开放联网；
4. 对全局联网情况试试监控，使用图表进行展示；
5. 针对联网IP或网址判断联网国家和联网目标进行分析；
6. 对于单个应用程序提供首次连接，最近一次连接，地点，系统，描述，MAC地址等等信息进行记录。
7. 对全局带宽和单个进程的带宽占用进行限制，限制最大上传带宽、下载最大带宽、最大连接时间、最多带宽用量
8. 可以像simplewall那样对默认防火墙进行配置和展示，提供更方便的防火墙管理形式
9. 对当前网速进行实时监测，并且在任务栏窗口或固定展示平台或浮动窗口；对历史网速进行保存（历史上传量、历史下载量、最大网速、）
10. 网络连接列表、网络监控连接、


| 顺位  | 功能描述                                 | 难度    | 依赖                 | 优先级说明                  |
| --- | ------------------------------------ | ----- | ------------------ | ---------------------- |
| 1️⃣ | **监控所有流量：IP、端口、协议、方向、程序路径**          | ⭐⭐⭐   | WinDivert + PID 解析 | 项目核心，先实现抓包并识别进程        |
| 2️⃣ | **记录连接详情：起始时间、时长、流量、程序信息（名称、版本、路径）** | ⭐⭐⭐   | 依赖 1️⃣             | 增加记录逻辑和结构化存储           |
| 3️⃣ | **数据库存储和图表展示（如流量趋势图）**               | ⭐⭐    | SQLite + 图表组件      | 增强可视化，提高实用性            |
| 4️⃣ | **新增联网进程提醒（白名单机制）**                  | ⭐⭐⭐⭐  | 依赖进程识别和状态持久化       | 需记录已知/未知进程状态           |
| 5️⃣ | **控制单个进程或全局流量（限速、拦截）**               | ⭐⭐⭐⭐⭐ | 依赖流量过滤和规则系统        | 使用 WinDivert 重定向或 Drop |
| 6️⃣ | **获取联网目标的国家/IP归属地**                  | ⭐⭐    | 使用 IP 地理库（GeoIP）   | 简单但增加外部依赖              |
| 7️⃣ | **进程连接历史分析：首次连接时间、最近连接、MAC、描述等**     | ⭐⭐⭐   | 依赖详细记录             | 属于增强功能，需较多存储和解析逻辑      |
| 8️⃣ | **防火墙可视化管理界面（集成系统规则或模拟 SimpleWall）** | ⭐⭐⭐⭐  | 调用系统 API 或完全自建规则系统 | 高价值但开发量大，可作为后期扩展       |


# 线程危险评估

1. 文件来源与完整性
   项目	说明	检查方式
   数字签名	是否有可信机构签名（如 Microsoft、Intel）	使用 WinVerifyTrust
   是否篡改	哈希是否与预期匹配	SHA256 + 数据库对比
   文件路径	是否位于系统可信目录（如 C:\Windows\System32）	检查 GetModuleFileName 路径
   ✅ 二、系统可信目录有哪些？
   系统目录不仅包括 C:\Windows\System32，还包括以下路径：

| 可信目录路径                                                | 说明                                    |
| ----------------------------------------------------- | ------------------------------------- |
| `C:\Windows\System32`                                 | 64 位系统组件                              |
| `C:\Windows\SysWOW64`                                 | 32 位系统组件（在 64 位 Windows 上）            |
| `C:\Windows\WinSxS`                                   | Windows 组件存储（side-by-side assemblies） |
| `C:\Windows\SystemApps`                               | UWP 系统应用                              |
| `C:\Windows\servicing`                                | 安装组件信息                                |
| `C:\Windows\explorer.exe`, `C:\Windows\notepad.exe` 等 | 核心 UI 组件                              |
| `C:\Program Files\Windows Defender`                   | Windows 自带安全软件                        |
| `C:\Program Files (x86)\Windows Defender`             | 同上，32 位版本                             |
| `C:\Program Files\WindowsApps`                        | Microsoft Store App 安装目录（注意权限控制）      |


2. 进程行为特征
   项目	说明	检查方式
   是否注入到其他进程	多见于恶意行为	使用 NtQueryInformationProcess 等 API 分析父子关系或钩子
   是否持续监听任意地址端口（如 0.0.0.0:445）	系统服务行为？还是可疑开放？	分析绑定地址行为（WinDivert可看到）
   是否创建大量连接（DoS/挖矿特征）	快速短连接、频繁连接多个IP	统计连接频次+连接数异常告警

3. 联网目标信息
   项目	说明	检查方式
   IP地址是否可疑	黑名单IP？海外？CN外？	GeoIP判断 + 威胁情报库
   是否连接知名矿池/VPN出口/恶意主机	对照IOC库（如 AbuseIPDB、VirusTotal）	提前集成威胁源数据库或定时更新本地数据库

4. 服务/父进程属性
   项目	说明	检查方式
   是哪一个服务创建的连接	是否为可信 Windows 服务？	结合 PID -> ServiceName 映射
   是 GUI 应用？还是隐藏进程？	无 UI 且持久后台更可疑	分析进程属性

5. 网络协议特征
   项目	说明	检查方式
   是否使用非典型协议（ICMP、ESP等）	除 TCP/UDP 外使用其他协议可能绕过控制	WinDivert 支持识别协议，过滤条件中 ip.Protocol == X
   是否通过 DNS tunneling	使用 DNS 协议进行数据传输	检查 DNS 请求的频率/长度/行为

6. 社区威胁情报
   项目	说明	检查方式
   是否为已知威胁行为	被社区/数据库标注为恶意程序	集成 VirusTotal、AbuseIPDB、HybridAnalysis API 等



# TODO LIST
2025年5月3日 19点42分
[ ] 获取联网程序和联网列表
